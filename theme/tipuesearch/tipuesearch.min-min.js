!function($){$.fn.tipuesearch=function(e){var t=$.extend({show:7,newWindow:!1,showURL:!0,showTitleCount:!0,minimumLength:3,descriptiveWords:25,highlightTerms:!0,highlightEveryTerm:!1,mode:"static",liveDescription:"*",liveContent:"*",contentLocation:"tipuesearch/tipuesearch_content.json",debug:!1},e);return this.each(function(){function e(e){return decodeURIComponent((new RegExp("[?|&]"+e+"=([^&;]+?)(&|#|;|$)").exec(location.search)||[,""])[1].replace(/\+/g,"%20"))||null}function i(e,a){$("#tipue_search_content").hide(),$("#tipue_search_content").html('<div class="tipue_search_spinner"><div class="tipue_search_rect1"></div><div class="tipue_search_rect2"></div><div class="rect3"></div></div>'),$("#tipue_search_content").show();var h="",n="",o=!1,p=!1,l=!0,u=0;found=[];var g=$("#tipue_search_input").val().toLowerCase();if(g=$.trim(g),(g.match('^"')&&g.match('"$')||g.match("^'")&&g.match("'$"))&&(l=!1),l){var _=g.split(" ");g="";for(var d=0;d<_.length;d++){for(var v=!0,f=0;f<tipuesearch_stop_words.length;f++)_[d]==tipuesearch_stop_words[f]&&(v=!1,p=!0);v&&(g=g+" "+_[d])}g=$.trim(g),_=g.split(" ")}else g=g.substring(1,g.length-1);if(g.length>=t.minimumLength){if(l){if(a){for(var w=g,d=0;d<_.length;d++)for(var f=0;f<tipuesearch_replace.words.length;f++)_[d]==tipuesearch_replace.words[f].word&&(g=g.replace(_[d],tipuesearch_replace.words[f].replace_with),o=!0);_=g.split(" ")}for(var m=g,d=0;d<_.length;d++)for(var f=0;f<tipuesearch_stem.words.length;f++)_[d]==tipuesearch_stem.words[f].word&&(m=m+" "+tipuesearch_stem.words[f].stem);_=m.split(" ");for(var d=0;d<s.pages.length;d++){for(var x=0,b=s.pages[d].text,f=0;f<_.length;f++){var L=new RegExp(_[f],"gi");if(-1!=s.pages[d].title.search(L)){var E=s.pages[d].title.match(L).length;x+=20*E}if(-1!=s.pages[d].text.search(L)){var E=s.pages[d].text.match(L).length;x+=20*E}if(t.highlightTerms){if(t.highlightEveryTerm)var R=new RegExp("("+_[f]+")","gi");else var R=new RegExp("("+_[f]+")","i");b=b.replace(R,'<span class="h01">$1</span>')}if(-1!=s.pages[d].tags.search(L)){var E=s.pages[d].tags.match(L).length;x+=10*E}if(-1!=s.pages[d].url.search(L)&&(x+=20),0!=x)for(var C=0;C<tipuesearch_weight.weight.length;C++)s.pages[d].url==tipuesearch_weight.weight[C].url&&(x+=tipuesearch_weight.weight[C].score);_[f].match("^-")&&(L=new RegExp(_[f].substring(1),"i"),-1==s.pages[d].title.search(L)&&-1==s.pages[d].text.search(L)&&-1==s.pages[d].tags.search(L)||(x=0))}0!=x&&(found.push({score:x,title:s.pages[d].title,desc:b,url:s.pages[d].url}),u++)}}else for(var d=0;d<s.pages.length;d++){var x=0,b=s.pages[d].text,L=new RegExp(g,"gi");if(-1!=s.pages[d].title.search(L)){var E=s.pages[d].title.match(L).length;x+=20*E}if(-1!=s.pages[d].text.search(L)){var E=s.pages[d].text.match(L).length;x+=20*E}if(t.highlightTerms){if(t.highlightEveryTerm)var R=new RegExp("("+g+")","gi");else var R=new RegExp("("+g+")","i");b=b.replace(R,'<span class="h01">$1</span>')}if(-1!=s.pages[d].tags.search(L)){var E=s.pages[d].tags.match(L).length;x+=10*E}if(-1!=s.pages[d].url.search(L)&&(x+=20),0!=x)for(var C=0;C<tipuesearch_weight.weight.length;C++)s.pages[d].url==tipuesearch_weight.weight[C].url&&(x+=tipuesearch_weight.weight[C].score);0!=x&&(found.push({score:x,title:s.pages[d].title,desc:b,url:s.pages[d].url}),u++)}if(0!=u){if(t.showTitleCount&&0==r){var T=document.title;document.title="("+u+") "+T,r++}1==o&&(h+='<div id="tipue_search_warning">'+tipuesearch_string_2+" "+g+". "+tipuesearch_string_3+' <a id="tipue_search_replaced">'+w+"</a></div>"),1==u?h+='<div id="tipue_search_results_count">'+tipuesearch_string_4+"</div>":(c_c=u.toString().replace(/\B(?=(\d{3})+(?!\d))/g,","),h+='<div id="tipue_search_results_count">'+c_c+" "+tipuesearch_string_5+"</div>"),found.sort(function(e,t){return t.score-e.score});for(var y=0,d=0;d<found.length;d++){if(y>=e&&y<t.show+e){if(h+='<div class="tipue_search_content_title"><a href="'+found[d].url+'"'+c+">"+found[d].title+"</a></div>",t.debug&&(h+='<div class="tipue_search_content_debug">Score: '+found[d].score+"</div>"),t.showURL){var k=found[d].url.toLowerCase();0==k.indexOf("http://")&&(k=k.slice(7)),h+='<div class="tipue_search_content_url"><a href="'+found[d].url+'"'+c+">"+k+"</a></div>"}if(found[d].desc){var W=found[d].desc,j="",O=W.split(" ");if(O.length<t.descriptiveWords)j=W;else for(var f=0;f<t.descriptiveWords;f++)j+=O[f]+" ";j=$.trim(j),"."!=j.charAt(j.length-1)&&(j+=" ..."),h+='<div class="tipue_search_content_text">'+j+"</div>"}}y++}if(u>t.show){var S=Math.ceil(u/t.show),D=e/t.show;if(h+='<div id="tipue_search_foot"><ul id="tipue_search_foot_boxes">',e>0&&(h+='<li><a class="tipue_search_foot_box" id="'+(e-t.show)+"_"+a+'">'+tipuesearch_string_6+"</a></li>"),D<=2){var U=S;S>3&&(U=3);for(var f=0;f<U;f++)h+=f==D?'<li class="current">'+(f+1)+"</li>":'<li><a class="tipue_search_foot_box" id="'+f*t.show+"_"+a+'">'+(f+1)+"</a></li>"}else{var U=D+2;U>S&&(U=S);for(var f=D-1;f<U;f++)h+=f==D?'<li class="current">'+(f+1)+"</li>":'<li><a class="tipue_search_foot_box" id="'+f*t.show+"_"+a+'">'+(f+1)+"</a></li>"}D+1!=S&&(h+='<li><a class="tipue_search_foot_box" id="'+(e+t.show)+"_"+a+'">'+tipuesearch_string_7+"</a></li>"),h+="</ul></div>"}}else h+='<div id="tipue_search_warning">'+tipuesearch_string_8+"</div>"}else p?h+='<div id="tipue_search_warning">'+tipuesearch_string_8+". "+tipuesearch_string_9+"</div>":(h+='<div id="tipue_search_warning">'+tipuesearch_string_10+"</div>",1==t.minimumLength?h+='<div id="tipue_search_warning">'+tipuesearch_string_11+"</div>":h+='<div id="tipue_search_warning">'+tipuesearch_string_12+" "+t.minimumLength+" "+tipuesearch_string_13+"</div>");$("#tipue_search_content").hide(),$("#tipue_search_content").html(h),$("#tipue_search_content").slideDown(200),$("#tipue_search_replaced").click(function(){i(0,!1)}),$(".tipue_search_foot_box").click(function(){var e=$(this).attr("id"),t=e.split("_");i(parseInt(t[0]),t[1])})}var s={pages:[]};$.ajaxSetup({async:!1});var r=0;if("live"==t.mode)for(var a=0;a<tipuesearch_pages.length;a++)$.get(tipuesearch_pages[a]).done(function(e){var i=$(t.liveContent,e).text();i=i.replace(/\s+/g," ");var r=$(t.liveDescription,e).text();r=r.replace(/\s+/g," ");var c=e.toLowerCase().indexOf("<title>"),h=e.toLowerCase().indexOf("</title>",c+7);if(-1!=c&&-1!=h)var n=e.slice(c+7,h);else var n=tipuesearch_string_1;s.pages.push({title:n,text:r,tags:i,url:tipuesearch_pages[a]})});"json"==t.mode&&$.getJSON(t.contentLocation).done(function(e){s=$.extend({},e)}),"static"==t.mode&&(s=$.extend({},tipuesearch));var c="";t.newWindow&&(c=' target="_blank"'),e("q")&&($("#tipue_search_input").val(e("q")),i(0,!0)),$(this).keyup(function(e){"13"==e.keyCode&&i(0,!0)})})}}(jQuery);